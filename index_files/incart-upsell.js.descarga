customElements.get("foxkit-incart-upsell")||customElements.define("foxkit-incart-upsell",class extends HTMLElement{constructor(){super()}connectedCallback(){this.setupData(),this.getOffer().then((async()=>{if(this.config){FoxKitV2.cart||await FoxKitV2.getCart(),this.renderComponent();const t=document.querySelectorAll(`foxkit-incart-upsell[data-offer-id="${this.config._id}"]`);for(const[i,e]of t.entries())0!==i&&e.remove()}else this.destroy()}))}setupData(){this.wrapperClass=".foxkit-incart-wrapper",this.config={},this.productId=null,this.products=[],this.settings=window.FoxKitPlugins.IncartSettings||{offer_heading:"",card_style:"style-1",image_ratio:"adapt",btn_style:"text",button_label:"",slider_control:!1},this.productId=Number(this.dataset.productId),this.productTitle=this.dataset.productTitle,this.classList.add("foxkit-incart-upsell","foxkit-incart-items","m:w-full"),this.prioritySort=this.dataset.prioritySort}async getOffer(){let t={plg:"inCart",productId:this.productId};const i=this.dataset.collections;i&&(t.collectionIds=i.split(",").filter(Boolean)),this.config=await FoxKitV2.Helpers.getPluginData(t)}renderComponent(){if(this.products=this.config.products||[],FoxKitV2.cart&&FoxKitV2.cart.items){const t=(FoxKitV2.cart.items||[]).map((t=>t.product_id));this.products=this.products.filter((i=>!t.includes(i.id)))}if(this.prioritySort){const t=(FoxKitV2.cart.items||[]).map((t=>t.product_id)).filter((t=>this.config?.target_products?.includes(`gid://shopify/Product/${t}`)));for(const i of t){if(this.productId!==i)return this.destroy();if(this.productId===i)break}}let t=!1;const i=document.querySelectorAll(`foxkit-incart-upsell[data-offer-id="${this.config._id}"]`);for(const e of Array.from(i)){const i=window.getComputedStyle(e),s=e.getBoundingClientRect();"none"!==i.display&&"hidden"!==i.visibility&&"0"!==i.opacity&&0!==s.width&&0!==s.height&&this!==e&&(t=!0)}if(!this.products.length||t)return this.destroy();this.dataset.offerId=this.config._id;const e=document.createElement("foxkit-visible-check"),s=document.createElement("foxkit-component");s.classList.add("f-incart"),s.dataset.plugin="InCart";const n="cart"===FoxKitSettings.template?"cart-page":"cart-drawer";this.classList.add(`f-incart--${n}`);const o=this.getDiscountHtml(),r=this.getTitleHtml(),a=this.getProductsListHtml();if(!a)return this.destroy();const d=this.getSliderControls(this.products.length);let c="";"cart-page"!==n&&(c=' data-slides-per-page="1"'),s.innerHTML=`${r}${o}<foxkit-slider-component class="foxkit-slider"${c}>${a}${d}</foxkit-slider-component>`,e.appendChild(s),this.innerHTML="",this.appendChild(e),s.querySelectorAll("foxkit-product-card").forEach(((t,i)=>{const e=t.dataset.productId,s=this.products.find((t=>t.id===Number(e)));s&&t.setupData(s)})),s.setConfig(this.config)}getTitleHtml(){return`<h3 class="f-incart__title">${this.settings.offer_heading?window.__i18n.transPlugin({configs:this.settings,key:"offer_heading",_params:{product_title:this.productTitle}}):window.__i18n.tr("incart_title",{product_title:this.productTitle})}</h3>`}getDiscountHtml(){const{discount:t,active_discount:i}=this.config,e=document.createElement("div");return e.appendChild(window.FoxKitV2.Helpers.getDiscountSummary(t)),i?`<div class="f-upsell__discount"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="19" fill="none" viewBox="0 0 18 19"><path fill="#DA3F3F" d="M17.4375 7.49219C17.8125 8.00781 18 8.59375 18 9.25s-.1875 1.2539-.5625 1.793c-.375.5156-.8555.8789-1.4414 1.0898.2578.5625.3281 1.1719.2109 1.8281-.0937.6329-.375 1.1836-.8437 1.6524-.4688.4687-1.0195.75-1.6524.8437-.6328.1172-1.2421.0469-1.8281-.2109-.1406.3984-.3516.7383-.6328 1.0195-.2812.3047-.6211.5391-1.0195.7032-.37503.1874-.78519.2812-1.2305.2812-.65625 0-1.25391-.1875-1.79297-.5625-.51562-.375-.87891-.8555-1.08984-1.4414-.58594.2578-1.19531.3281-1.82813.2109-.63281-.0937-1.18359-.375-1.65234-.8437-.46875-.4688-.76172-1.0195-.87891-1.6524-.09375-.6562-.01172-1.2656.2461-1.8281C1.41797 11.9219.9375 11.5586.5625 11.043.1875 10.5039 0 9.90625 0 9.25s.1875-1.24219.5625-1.75781c.375-.53906.85547-.91407 1.44141-1.125-.25782-.5625-.33985-1.16016-.2461-1.79297.11719-.65625.41016-1.21875.87891-1.6875.46875-.46875 1.01953-.75 1.65234-.84375.65625-.11719 1.26563-.04688 1.82813.21094.21093-.58594.57422-1.06641 1.08984-1.44141C7.74609.4375 8.34375.25 9 .25s1.2422.1875 1.7578.5625c.5391.375.9141.85547 1.125 1.44141.5625-.25782 1.1602-.32813 1.793-.21094.6562.09375 1.2187.375 1.6875.84375.4687.46875.75 1.03125.8437 1.6875.1172.63281.0469 1.23047-.2109 1.79297.5859.21093 1.0664.58594 1.4414 1.125zM7.52344 6.22656C7.3125 5.99219 7.05469 5.875 6.75 5.875s-.57422.11719-.80859.35156C5.73047 6.4375 5.625 6.69531 5.625 7s.10547.57422.31641.80859c.23437.21094.5039.31641.80859.31641s.5625-.10547.77344-.31641C7.75781 7.57422 7.875 7.30469 7.875 7s-.11719-.5625-.35156-.77344zm-.35156 6.04684l4.85152-4.85152c.2578-.25782.2578-.51563 0-.77344l-.4218-.42188c-.2578-.25781-.5157-.25781-.7735 0L5.97656 11.0781c-.25781.2578-.25781.5157 0 .7735l.42188.4218c.25781.2578.51562.2578.77344 0zm3.26952.0352c.2344.2109.5039.3164.8086.3164.3047 0 .5625-.1055.7734-.3164.2344-.2344.3516-.5039.3516-.8086 0-.3047-.1172-.5625-.3516-.7734-.2109-.2344-.4687-.3516-.7734-.3516-.3047 0-.5742.1172-.8086.3516-.2109.2109-.3164.4687-.3164.7734 0 .3047.1055.5742.3164.8086z"></path></svg>${e.innerHTML}</div>`:""}getProductsListHtml(){let t="";return this.products.forEach(((i,e)=>{t+=this.getProductHtml(i,e)})),t?`<div id="Slider-InCart-${this.config._id}" class="f-incart__products foxkit-slider__wrapper foxkit-slider--everywhere">${t}</div>`:""}getSliderControls(t){return this.settings.slider_control?`<div class="foxkit-slider__control">\n        <button type="button" class="foxkit-slider__button foxkit-slider__button--prev" name="previous" aria-label="Slide left">\n          <svg aria-hidden="true" focusable="false" viewBox="0 0 10 6">\n            <path fill-rule="evenodd" clip-rule="evenodd" d="M9.354.646a.5.5 0 00-.708 0L5 4.293 1.354.646a.5.5 0 00-.708.708l4 4a.5.5 0 00.708 0l4-4a.5.5 0 000-.708z" fill="currentColor"></path>\n          </svg>\n        </button>\n        <div class="foxkit-slider__counter">\n          <span class="foxkit-slider__counter--current">1</span>\n          <span aria-hidden="true"> / </span>\n          <span class="f-visually-hidden">of</span>\n          <span class="foxkit-slider__counter--total">${t}</span>\n        </div>\n        <button type="button" class="foxkit-slider__button foxkit-slider__button--next" name="next" aria-label="Slide right">\n          <svg aria-hidden="true" focusable="false" viewBox="0 0 10 6">\n            <path fill-rule="evenodd" clip-rule="evenodd" d="M9.354.646a.5.5 0 00-.708 0L5 4.293 1.354.646a.5.5 0 00-.708.708l4 4a.5.5 0 00.708 0l4-4a.5.5 0 000-.708z" fill="currentColor"></path>\n          </svg>\n        </button>\n      </div>`:""}getProductHtml(t,i){const{available:e,handle:s}=t;if(!t||!e||t.id===this.productId)return"";const{moneyFormat:n}=FoxKitSettings,o=`${Shopify.routes.root}products/${s}`,r=t.variants.filter((t=>t.available))[0],a=1===t.variants.length&&"default title"===r.title.toLowerCase(),d=this.config.id||this.config._id,c=`<input type="hidden" name="properties[${window.FoxKitV2.FOXKIT_LINE_OFFER_KEY}]" value="InCart:${d}" />`;let l=`<input type="hidden" name="id" value="${r.id}" />`;const p=`<span class="foxkit-product-card__price">${window.FoxKitV2.Utils.formatMoney(r.price,n)}</span>`;let u="foxkit-product-card__compare-price";(!r.compare_at_price||r.compare_at_price<r.price)&&(u+=" foxkit-hidden");window.FoxKitV2.Utils.formatMoney(r.compare_at_price,n);const f=`<div class="foxkit-card__prices">\n          ${p}\n        </div>`;if(!a){let i="";t.variants.forEach((t=>{let e="";t.available||(e+=' disabled="true"'),t.id===r.id&&(e+=" selected"),i+=`<option value="${t.id}"${e}>${t.title}</option>`})),l=`<div class="f-incart__product-options">\n          <select\n            name="id"\n            class="foxkit-form-control combined-variant"\n          >\n            ${i}\n          </select>\n        </div>`}const h=this.settings.image_ratio;let _;switch(h){case"portrait":_="3/4";break;case"landscape":_="16/9";break;default:_="1/1"}let g="";"adapt"!==h&&(g=`--foxkit-aspect-ratio: ${_}`);let m=`foxkit-slider__slide f-incart__product f-incart__product--${this.settings.card_style} f-incart__product--image-${h}`;a&&(m+=" f-incart__product--no-variants");const x=this.settings.button_label?window.__i18n.transPlugin({configs:this.settings,key:"button_label"}):window.__i18n.tr("add_button");return`<foxkit-product-card id="Slide-InCart-${i}" class="${m}" data-plugin="InCart" data-product-id="${t.id}">\n        <form class="f-incart__product-inner foxkit-product-form">\n          ${c}\n          <div class="f-incart__product-image" style="${g}">\n            <a href="${o}">\n              <img\n                src="${t.featured_image?`${t.featured_image}&width=200`:"https://dummyimage.com/100x/ddd/aaa"}"\n                alt="${t.title}"\n                class="foxkit-product-card__img"\n              />\n            </a>\n          </div>\n          <div class="f-incart__product-info">\n            <div>\n              <h3 class="f-incart__product-title">\n                <a href="${o}">${t.title}</a>\n              </h3>\n              ${l}\n              ${a?f:""}\n            </div>\n            <div>\n              ${a?"":f}\n              <button\n                name="foxkit-add"\n                class="f-incart__product-add f-incart__product-add--${this.settings.btn_style} foxkit-button foxkit-button--primary"\n                data-atc-text="${x}"\n              >\n                <span class="foxkit-spinner">\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none">\n          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" />\n          <path fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" />\n        </svg>\n      </span>\n                ${"icon"===this.settings.btn_style?'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 16 17" fill="none">\n        <g>\n          <path d="M2.5 8.16669H13.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n          <path d="M8 2.66669V13.6667" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n        </g>\n      </svg>':`<span class="atc-text">${x}</span>`}\n              </button>\n            </div>\n          </div>\n        </form>\n      </foxkit-product-card>`}destroy(){const t=this.closest(this.wrapperClass);this.remove(),t&&t.remove()}});